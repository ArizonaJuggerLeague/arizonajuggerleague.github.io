<!doctype html><html class="no-js" lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Создание градиентной заливки</title><link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/styles_feeling_responsive_light.css"><link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/styles_feeling_responsive.css"> <script src="http://localhost:4000/assets/js/modernizr.min.js"></script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script> <script> WebFont.load({ google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }); </script> <noscript><link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'> </noscript><meta name="description" content="Полностью расписанный и объяснённый исходник градиентной заливки формы. Оригинальный исходник написал Y0da"><link rel="canonical" href="http://localhost:4000/russian/gradient/"><meta property="og:title" content="Создание градиентной заливки"><meta property="og:description" content="Полностью расписанный и объяснённый исходник градиентной заливки формы. Оригинальный исходник написал Y0da"><meta property="og:url" content="http://localhost:4000/russian/gradient/"><meta property="og:locale" content="en_EN"><meta property="og:type" content="website"><meta property="og:site_name" content="Arizona Jugger League"><meta property="article:author" content="https://www.facebook.com/Arizona Jugger League"><link type="text/plain" rel="author" href="http://localhost:4000/humans.txt"><link rel="icon" sizes="32x32" href="http://localhost:4000/assets/img/favicon-32x32.png"><link rel="icon" sizes="192x192" href="http://localhost:4000/assets/img/touch-icon-192x192.png"><link rel="apple-touch-icon-precomposed" sizes="180x180" href="http://localhost:4000/assets/img/apple-touch-icon-180x180-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:4000/assets/img/apple-touch-icon-152x152-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/img/apple-touch-icon-144x144-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:4000/assets/img/apple-touch-icon-120x120-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/img/apple-touch-icon-114x114-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:4000/assets/img/apple-touch-icon-76x76-precomposed.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/img/apple-touch-icon-72x72-precomposed.png"><link rel="apple-touch-icon-precomposed" href="http://localhost:4000/assets/img/apple-touch-icon-precomposed.png"><meta name="msapplication-TileImage" content="http://localhost:4000/assets/img/msapplication_tileimage.png"><meta name="msapplication-TileColor" content="#fabb00"><body id="top-of-page" class="post"><div id="navigation" class="sticky"><nav class="top-bar" role="navigation" data-topbar><ul class="title-area"><li class="name"><h1 class="show-for-small-only"><a href="http://localhost:4000" class="icon-tree"> Arizona Jugger League</a></h1><li class="toggle-topbar menu-icon"><a href="#"><span>Navigation</span></a></ul><section class="top-bar-section"><ul class="right"><li class="divider"><li><a href="http://localhost:4000/search/">Search</a><li class="divider"><li><a href="http://localhost:4000/about/">About</a></ul><ul class="left"><li><a href="http://localhost:4000/">DeXP</a><li class="divider"><li><a href="http://localhost:4000/games/">Games</a><li class="divider"><li><a href="http://localhost:4000/tools/">Tools</a><li class="divider"><li><a href="http://localhost:4000/sites/">Sites</a><li class="divider"><li><a href="http://localhost:4000/articles/">Articles</a><li class="divider"><li><a href="http://localhost:4000/photo/">Photo</a><li class="divider"><li><a href="http://localhost:4000/russian/">Russian</a><li class="divider"><li class="has-dropdown"> <a href="http://localhost:4000/blog/">Blog</a><ul class="dropdown"><li><a href="http://localhost:4000/blog/archive/">Blog Archive</a></ul><li class="divider"></ul></section></nav></div><div id="masthead-no-image-header"><div class="row"><div class="small-12 columns"> <a id="logo" href="http://localhost:4000/" title="Arizona Jugger League – Arizona Jugger League"> <img src="http://localhost:4000/assets/img/logo.png" alt="Arizona Jugger League – Arizona Jugger League"> </a></div></div></div><div class="row t30"><div class="medium-8 columns medium-offset-2 end"><article itemscope itemtype="http://schema.org/Article"><header><div itemprop="name"><p class="subheadline">Delphi<h1>Создание градиентной заливки</h1></div></header><p class="teaser" itemprop="description"> Полностью расписанный и объяснённый исходник градиентной заливки формы. Оригинальный исходник написал Y0da<div itemprop="articleSection"><p>Вы, наверное, замечали, что в инсталляторах заливка формы не одноцветна, а плавно переходит от одного цвета к другому. Это выглядит довольно красиво. Почему бы не встроить в свою программу подобный переход? Но только переход от синего к чёрному устарел. Почему бы не залить свою форму другими цветами? Ниже приведён код, реализующий всё это. Его надо просто дописать в свой проект. Вызов процедуры GradientForm должен быть помещён в событие формы OnPaint.<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">procedure</span> <span class="n">TForm1</span><span class="p">.</span><span class="n">GradientForm</span> <span class="p">(</span><span class="n">frm</span><span class="p">:</span> <span class="n">TForm</span><span class="p">;</span> <span class="n">startcolor</span><span class="p">,</span> <span class="n">endcolor</span><span class="p">:</span> <span class="n">TColor</span><span class="p">);</span> 
<span class="c1">// Горизонтальная градиентная заливка формы 
</span><span class="k">var</span> 
<span class="n">startr</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Стартовое количество красного цвета 
</span><span class="n">startg</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Стартовое количество зелёного цвета 
</span><span class="n">startb</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Стартовое количество синего цвета 
</span><span class="n">endr</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Конечное количество красного цвета 
</span><span class="n">endg</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Конечное количество зелёного цвета 
</span><span class="n">endb</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Конечное количество синего цвета 
</span><span class="n">curr</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Текущее количество красного цвета 
</span><span class="n">curg</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Текущее количество зелёного цвета 
</span><span class="n">curb</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Текущее количество синего цвета 
</span><span class="n">i</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> 
<span class="n">r</span> <span class="p">:</span> <span class="n">TRect</span><span class="p">;</span> <span class="c1">// Прямоугольник, который будет заполняться различными цветами 
</span><span class="n">nolines</span><span class="p">:</span> <span class="kt">byte</span><span class="p">;</span> <span class="c1">// количество прямоугольников 
</span><span class="n">curpct</span> <span class="p">:</span> <span class="kt">integer</span><span class="p">;</span> <span class="c1">// Текущий процент изменения окраски 
</span><span class="n">bitspix</span><span class="p">:</span> <span class="kt">longint</span><span class="p">;</span> <span class="c1">// биты в пикселе 
</span><span class="k">begin</span> 
<span class="c1">// конвертирует TColor в RGB 
</span><span class="n">startr</span> <span class="p">:=</span> <span class="n">GetRValue</span><span class="p">(</span><span class="n">startcolor</span><span class="p">);</span> 
<span class="n">startg</span> <span class="p">:=</span> <span class="n">GetGValue</span><span class="p">(</span><span class="n">startcolor</span><span class="p">);</span> 
<span class="n">startb</span> <span class="p">:=</span> <span class="n">GetBValue</span><span class="p">(</span><span class="n">startcolor</span><span class="p">);</span> 
<span class="n">endr</span> <span class="p">:=</span> <span class="n">GetRValue</span><span class="p">(</span><span class="n">endcolor</span><span class="p">);</span> 
<span class="n">endg</span> <span class="p">:=</span> <span class="n">GetGValue</span><span class="p">(</span><span class="n">endcolor</span><span class="p">);</span> 
<span class="n">endb</span> <span class="p">:=</span> <span class="n">GetBValue</span><span class="p">(</span><span class="n">endcolor</span><span class="p">);</span> 

<span class="c1">// Считает количество прямоугольников (линий) с различными цветами 
</span><span class="k">if</span> <span class="n">frm</span><span class="p">.</span><span class="n">Height</span> <span class="p">&lt;</span> <span class="m">250</span> <span class="k">then</span> 
<span class="n">nolines</span><span class="p">:=</span><span class="n">frm</span><span class="p">.</span><span class="n">Height</span> 
<span class="k">else</span> 
<span class="n">nolines</span><span class="p">:=</span><span class="m">250</span><span class="p">;</span> <span class="c1">// Максимум 250 прямоугольников (больше не нужно) 
// Получает количество битов в пикселе
</span><span class="n">bitspix</span><span class="p">:=</span><span class="n">GetDeviceCaps</span><span class="p">(</span><span class="n">frm</span><span class="p">.</span><span class="n">Canvas</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="n">BITSPIXEL</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">bitspix</span> <span class="p">=</span> <span class="m">8</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">nolines</span> <span class="p">&gt;</span> <span class="m">50</span><span class="p">)</span> <span class="k">then</span> <span class="c1">// 256 цветов 
</span><span class="n">nolines</span><span class="p">:=</span><span class="m">50</span> 
<span class="k">else</span> <span class="k">if</span> <span class="n">bitspix</span> <span class="p">&lt;</span> <span class="m">8</span> <span class="k">then</span> <span class="c1">// Меньше чем 256 цветов 
</span><span class="n">nolines</span><span class="p">:=</span><span class="m">4</span><span class="p">;</span> <span class="c1">// бедный парень! Это EGA монитор должен быть… 
</span>
<span class="n">r</span><span class="p">.</span><span class="n">Left</span><span class="p">:=</span><span class="m">0</span><span class="p">;</span> <span class="c1">// Left прямоугольника 
</span><span class="n">r</span><span class="p">.</span><span class="n">Right</span><span class="p">:=</span><span class="n">frm</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> <span class="c1">// Right прямоугольника 
</span>
<span class="k">for</span> <span class="n">i</span><span class="p">:=</span><span class="m">0</span> <span class="k">to</span> <span class="n">nolines</span> <span class="k">do</span> <span class="c1">// Рисует градиент 
</span><span class="k">begin</span> 

<span class="n">curpct</span><span class="p">:=</span> <span class="p">(</span><span class="n">i</span> <span class="p">*</span> <span class="m">100</span><span class="p">)</span> <span class="k">div</span> <span class="n">nolines</span><span class="p">;</span> <span class="c1">// % изменения (градиент) 
</span>
<span class="c1">// Вычисляет количество красного для текущего прямоугольника 
</span><span class="k">if</span> <span class="n">startr</span> <span class="p">&gt;</span> <span class="n">endr</span> <span class="k">then</span> 
<span class="n">curr</span> <span class="p">:=</span> <span class="n">startr</span> <span class="p">-</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">startr</span><span class="p">-</span><span class="n">endr</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">)</span> 
<span class="k">else</span> 
<span class="n">curr</span> <span class="p">:=</span> <span class="n">startr</span> <span class="p">+</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">endr</span><span class="p">-</span><span class="n">startr</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">);</span> 

<span class="c1">// Вычисляет количество зелёного для текущего прямоугольника 
</span><span class="k">if</span> <span class="n">startg</span> <span class="p">&gt;</span> <span class="n">endg</span> <span class="k">then</span> 
<span class="n">curg</span> <span class="p">:=</span> <span class="n">startg</span> <span class="p">-</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">startg</span><span class="p">-</span><span class="n">endg</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">)</span> 
<span class="k">else</span> 
<span class="n">curg</span> <span class="p">:=</span> <span class="n">startg</span> <span class="p">+</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">endg</span><span class="p">-</span><span class="n">startg</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">);</span> 

<span class="c1">// Вычисляет количество синего для текущего прямоугольника 
</span><span class="k">if</span> <span class="n">startb</span> <span class="p">&gt;</span> <span class="n">endb</span> <span class="k">then</span> 
<span class="n">curb</span> <span class="p">:=</span> <span class="n">startb</span> <span class="p">-</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">startb</span><span class="p">-</span><span class="n">endb</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">)</span> 
<span class="k">else</span> 
<span class="n">curb</span> <span class="p">:=</span> <span class="n">startb</span> <span class="p">+</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">endb</span><span class="p">-</span><span class="n">startb</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">);</span> 

<span class="c1">// Устанавливает RGB цвет для текущего прямоугольника 
</span><span class="n">frm</span><span class="p">.</span><span class="n">Canvas</span><span class="p">.</span><span class="n">Brush</span><span class="p">.</span><span class="n">Color</span><span class="p">:=</span><span class="n">RGB</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">curg</span><span class="p">,</span> <span class="n">curb</span><span class="p">);</span> 

<span class="c1">// Высчитывает вершину и нижнюю точку прямоугольника (top и bottom) 
</span><span class="n">r</span><span class="p">.</span><span class="n">Top</span><span class="p">:=</span><span class="n">i</span> <span class="p">+</span> <span class="p">(</span><span class="n">i</span><span class="p">*(</span><span class="n">frm</span><span class="p">.</span><span class="n">Height</span> <span class="k">div</span> <span class="n">nolines</span><span class="p">));</span> 
<span class="n">r</span><span class="p">.</span><span class="n">Bottom</span><span class="p">:=</span><span class="n">r</span><span class="p">.</span><span class="n">Top</span> <span class="p">+</span> <span class="p">(</span><span class="n">frm</span><span class="p">.</span><span class="n">Height</span> <span class="k">div</span> <span class="n">nolines</span><span class="p">)+</span><span class="m">1</span><span class="p">;</span> 

<span class="c1">// Рисует прямоугольник на холсте (на canvas) 
</span><span class="n">frm</span><span class="p">.</span><span class="n">Canvas</span><span class="p">.</span><span class="n">FillRect</span><span class="p">(</span><span class="n">r</span><span class="p">);</span> 
<span class="k">end</span><span class="p">;</span> <span class="c1">// Конец цикла for 
</span><span class="k">end</span><span class="p">;</span> <span class="c1">// Конец процедуры GradientForm 
</span>


<span class="k">procedure</span> <span class="n">TForm1</span><span class="p">.</span><span class="n">FormPaint</span><span class="p">(</span><span class="n">Sender</span><span class="p">:</span> <span class="kt">TObject</span><span class="p">);</span> 
<span class="k">begin</span> 
<span class="c1">// от светло-синего к чёрному - как в инсталляторах 
</span><span class="n">GradientForm</span><span class="p">(</span><span class="n">Form1</span><span class="p">,</span><span class="n">RGB</span><span class="p">(</span><span class="m">60</span><span class="p">,</span><span class="m">60</span><span class="p">,</span><span class="m">210</span><span class="p">),</span> <span class="n">RGB</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">));</span> 
<span class="c1">// Вместо RGB(60,60,210) и RGB(1,1,2) можно использовать свои цвета,
// включая цветовые константы Delphi типа clWhite, clBlack и т.д. 
</span><span class="k">end</span><span class="p">;</span> 
</code></pre></div></div><p>Теперь рассмотрим пошагово, что здесь происходило.<p>Начнём с самого начала:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">procedure</span> <span class="n">TForm1</span><span class="p">.</span><span class="n">GradientForm</span> <span class="p">(</span><span class="n">frm</span><span class="p">:</span> <span class="n">TForm</span><span class="p">;</span> <span class="n">startcolor</span><span class="p">,</span> <span class="n">endcolor</span><span class="p">:</span> <span class="n">TColor</span><span class="p">);</span>
</code></pre></div></div><p>Что передаётся в эту процедуру? Всё очень легко. Frm – та форма, которую нужно градиентно залить. StartColor и EndColor – цвета, которыми будет начинаться и кончаться заливка соответственно. Здесь ничего менять не надо – это просто заголовок.<p>Переменные откомментированы достаточно хорошо, так что переходим дальше.<p>Конвертация цветов.<p>Что такое цвет? На самом деле каждый цвет можно разложить на три составляющие: красную, зелёную, голубую. Это так называемый RGB: Red, Green, Blue. Для передачи RGB служат четырёх битные переменные. Почему? Да потому, что для каждого цвета выделено по одному байту. Почему тогда наша переменная не 3 байтная, ведь цветов всего три? - спросите вы. Дело в том, что в основе компьютера лежит двоичная система счисления. Т.е. всё должно быть кратным степеням двойки. Именно поэтому 4. Последний байт в обычных офисных приложениях чаще всего пустует. А в играх ему нашли применение – этот байт отвечает за прозрачность цвета.<p>Так вот, каждый бит – это 8 байт. Бит может принимать значение 0 , или 1. Следовательно байт может содержать два в восьмой степени различных комбинаций, т.е. 256 различных комбинаций. В шестнадцатеричной системе счисления ближайшее число FF. Из этого всего понятно, что цвет представляется в виде $00FFFFFF, где $ означает, что число представлено в шестнадцатеричной системе счисления остальные пары чисел обозначают цвета. Например $00FF0000 –синий цвет, $0000FF00 – зелёный цвет, $000000FF – красный.<p>Дальше мы разбиваем цвет на его составляющие. Для этого есть такие стандартные процедуры: GetRValue – получить красную составляющую, GetGValue – получить зелёную составляющую, GetBValue – получить синюю (голубую) составляющую.<p>С цветом вроде бы как разобрались. Поехали дальше!<p>Залить форму плавно изменяющимся цветом, конечно же не получиться. Но можно нарисовать много-много разноцветных маленьких прямоугольничков, которые создадут эффект плавного перехода цвета. Возникает проблема, сколько же нужно таких прямоугольничков? Больше 250 их не имеет смысла делать – заметно все равно не будет, а ресурсы будет «жрать» здорово. А если высота нашей формы меньше 250 пикселей, то тогда делать 250 прямоугольников бессмысленно. Тогда создадим количество прямоугольников, равное высоте нашей формы, т.е. у каждого горизонтального ряда пикселей будет свой уникальный цвет:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">frm</span><span class="p">.</span><span class="n">Height</span> <span class="p">&lt;</span> <span class="m">250</span> <span class="k">then</span> 
<span class="n">nolines</span><span class="p">:=</span><span class="n">frm</span><span class="p">.</span><span class="n">Height</span> 
<span class="k">else</span> 
<span class="n">nolines</span><span class="p">:=</span><span class="m">250</span><span class="p">;</span> <span class="c1">// Максимум 250 прямоугольников (больше не нужно) 
</span></code></pre></div></div><p>Дальше идёт проверка количества цветов. Функция GetDeviceCaps возвращает количество цветов, поддерживаемых монитором. Например, цвет True Color соответствует 32 битам. На большинстве современных мониторов он поддерживается. Тогда имеет смысл рисовать до 250 прямоугольников – и у всех будет разный цвет. Если же у нас цвет только 8 битный, то больше 50 прямоугольников рисовать не имеет смысла. Если нарисовать больше, то рядом стоящие прямоугольники почти не будут отличаться:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bitspix</span><span class="p">:=</span><span class="n">GetDeviceCaps</span><span class="p">(</span><span class="n">frm</span><span class="p">.</span><span class="n">Canvas</span><span class="p">.</span><span class="n">Handle</span><span class="p">,</span> <span class="n">BITSPIXEL</span><span class="p">);</span> 
<span class="k">if</span> <span class="p">(</span><span class="n">bitspix</span> <span class="p">=</span> <span class="m">8</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="n">nolines</span> <span class="p">&gt;</span> <span class="m">50</span><span class="p">)</span> <span class="k">then</span> 
<span class="n">nolines</span><span class="p">:=</span><span class="m">50</span> 
<span class="k">else</span> <span class="k">if</span> <span class="n">bitspix</span> <span class="p">&lt;</span> <span class="m">8</span> <span class="k">then</span> 
<span class="n">nolines</span><span class="p">:=</span><span class="m">4</span><span class="p">;</span> 
</code></pre></div></div><p>Естественно, что наши прямоугольнички должны тянуться на всю ширину формы. Для этого достаточно их левую границу поставить в 0, а правой присвоить ширину формы:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r</span><span class="p">.</span><span class="n">Left</span><span class="p">:=</span><span class="m">0</span><span class="p">;</span> <span class="c1">// Left прямоугольника 
</span><span class="n">r</span><span class="p">.</span><span class="n">Right</span><span class="p">:=</span><span class="n">frm</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> <span class="c1">// Right прямоугольника 
</span></code></pre></div></div><p>Теперь нам известно общее количество прямоугольников, их ширина. Теперь запустим цикл для рисования каждого из прямоугольников. Цвет прямоугольников будет отличаться. Причём на какой-то определённый процент. Этот процент можно рассчитать по формуле:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">curpct</span><span class="p">:=</span> <span class="p">(</span><span class="n">i</span> <span class="p">*</span> <span class="m">100</span><span class="p">)</span> <span class="k">div</span> <span class="n">nolines</span><span class="p">;</span> 
</code></pre></div></div><p>Выводится довольно просто: 100% - это у нас nolines (количество прямоугольников). Х – текущий процент, при линии i. Следовательно, Х будет равен i*100 и всё это разделить на общее количество линий. Известен процент изменения, как же посчитать текущий цвет? А вот так (на примере красной составляющей):<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">startr</span> <span class="p">&gt;</span> <span class="n">endr</span> <span class="k">then</span> 
<span class="n">curr</span> <span class="p">:=</span> <span class="n">startr</span> <span class="p">-</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">startr</span><span class="p">-</span><span class="n">endr</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">)</span> 
<span class="k">else</span> 
<span class="n">curr</span> <span class="p">:=</span> <span class="n">startr</span> <span class="p">+</span> <span class="p">(</span><span class="n">curpct</span> <span class="p">*</span> <span class="p">(</span><span class="n">endr</span><span class="p">-</span><span class="n">startr</span><span class="p">)</span> <span class="k">div</span> <span class="m">100</span><span class="p">);</span> 
</code></pre></div></div><p>Т.е. изменение цвета будет равно текущий процент умножить на общую разницу цветов и всё это разделить на 100%. Смысл условия if таков: если начальный цвет светлее конечного, то текущий цвет должен темнеть (например, белый $00FFFFFF больше чёрного $00000000). Иначе, если начальный темнее конечного, то текущий должен светлеть. Таким образом определяем каждую из составляющих текущего цвета.<p>Теперь нам известны все составляющие текущего цвета, именно этим цветом мы сейчас и будем рисовать:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">frm</span><span class="p">.</span><span class="n">Canvas</span><span class="p">.</span><span class="n">Brush</span><span class="p">.</span><span class="n">Color</span><span class="p">:=</span><span class="n">RGB</span><span class="p">(</span><span class="n">curr</span><span class="p">,</span> <span class="n">curg</span><span class="p">,</span> <span class="n">curb</span><span class="p">);</span> 
</code></pre></div></div><p>Нам всё известно, кроме верхней нижней точки прямоугольника. Найдём их:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">r</span><span class="p">.</span><span class="n">Top</span><span class="p">:=</span><span class="n">i</span> <span class="p">+</span> <span class="p">(</span><span class="n">i</span><span class="p">*(</span><span class="n">frm</span><span class="p">.</span><span class="n">Height</span> <span class="k">div</span> <span class="n">nolines</span><span class="p">));</span> 
<span class="n">r</span><span class="p">.</span><span class="n">Bottom</span><span class="p">:=</span><span class="n">r</span><span class="p">.</span><span class="n">Top</span> <span class="p">+</span> <span class="p">(</span><span class="n">frm</span><span class="p">.</span><span class="n">Height</span> <span class="k">div</span> <span class="n">nolines</span><span class="p">)+</span><span class="m">1</span><span class="p">;</span> 
</code></pre></div></div><p>Доказывается это аналогично проценту изменения цвета. (Если Вы в школе учили математику, то доказать это не составит Вам проблем J). Всё готово! Теперь можем рисовать прямоугольник:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">frm</span><span class="p">.</span><span class="n">Canvas</span><span class="p">.</span><span class="n">FillRect</span><span class="p">(</span><span class="n">r</span><span class="p">);</span> 
</code></pre></div></div><p>Вот так работает данная программа. Как использовать это в своих целях? Да очень просто. Дописываете процедуру TForm1.GradientForm к своему проекту в нужный юнит, конечно, меняя TForm1 на название вашей формы. Не забудьте дописать эту процедуру в разделе описания типа формы. Потом создаёте для этой формы обработчик события OnPaint и в нём пишите:<div class="language-pascal highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">GradientForm</span><span class="p">(</span><span class="n">Form1</span><span class="p">,</span><span class="n">RGB</span><span class="p">(</span><span class="m">60</span><span class="p">,</span><span class="m">60</span><span class="p">,</span><span class="m">210</span><span class="p">),</span> <span class="n">RGB</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">));</span> 
</code></pre></div></div><p>Вместо Form1 передавая название вашей формы. Можно передавать свои цвета. Немного поэкспериментировав можно найти вполне неплохие сочетания.<h2 class="t60" id="other-delphi">Other Delphi</h2><ul class="side-nav"><li><a href="http://localhost:4000/tools/kruskal/">Delphi &middot; <strong>Kruskal's algorithm implementation</strong></a><li><a href="http://localhost:4000/russian/binary-heap/">Алгоритмы &middot; <strong>Структура данных бинарная куча</strong></a><li><a href="http://localhost:4000/tools/maximum-flow/">Delphi &middot; <strong>Maximum Flow implementation</strong></a><li><a href="http://localhost:4000/russian/graph-storage/">Алгоритмы &middot; <strong>Способы хранения графов в памяти компьютера</strong></a><li><a href="http://localhost:4000/tools/dijkstra/">Delphi &middot; <strong>Dijkstra implementation</strong></a></ul></div><div id="page-meta" class="t30"><p> <time class="icon-calendar pr20" datetime="2005-03-11T00:00:00-07:00" itemprop="datePublished"> 2005-03-11</time> <span class="icon-archive pr20"> RUSSIAN</span> <br /> <span class="pr20"><span class="icon-price-tag pr10"> russian</span> <span class="icon-price-tag pr10"> delphi</span> <span class="icon-price-tag pr10"> gui</span> <span class="icon-price-tag pr10"> алгоритм</span> </span><div id="post-nav" class="row"><div class="small-5 columns"><a class="button small radius prev" href="http://localhost:4000/tools/first-calculator/">&laquo; Calculator for Windows</a></div><div class="small-2 columns text-center"><a class="radius button small" href="http://localhost:4000/blog/archive/" title="Blog Archive">Archive</a></div><div class="small-5 columns text-right"><a class="button small radius next" href="http://localhost:4000/tools/winapicalc/">WinApiCalc by DeXPeriX &raquo;</a></div></div></div><section class="comments"><div class="constrain--body"><div class="comments__existing js-comments"><h3 id="comments" class="t60">Dialogue &amp; Discussion</h3><article id="comment1"> <img class=" left" width="100" height="100" src="https://www.gravatar.com/avatar/a713c94ab63e4e5184f87dcd7f0f2471?d=mm&s=100"><div><h3> <a rel="nofollow" href="https://dexp.in">DeXPeriX</a></h3><p> <a href="#comment1"> Saturday, February 18th, 2006, 05.00pm </a><div><p>Это моя самая первая статья, так что не судите строго! ;) Обновлять я её не буду - лучше напишу что-нибудь более полезное и новое, но и удалять не буду - пускай останется для истории :)</div></div></article></div><h2 class="comments__heading heading-2">Leave a comment</h2><form id="post-new-comment" class="form" action="https://api.staticman.net/v2/entry/DeXP/dexp.github.io/master/comments" method="post"> <input type="hidden" name="options[slug]" value="russian-gradient"> <input type="hidden" name="options[parent]" value="russian-gradient"> <input type="hidden" name="options[origin]" value="http://localhost:4000/russian/gradient/"> <input type="hidden" name="options[redirect]" value="http://localhost:4000/russian/gradient/"> <input type="text" name="company" class="text-field" style="display: none"> <input class="form__field text-field" type="text" name="fields[name]" placeholder="Name" required/> <input class="form__field text-field" type="email" name="fields[email]" placeholder="Email address (will not be public; for avatar only)" required/> <input class="form__field text-field" type="url" name="fields[url]" placeholder="Website (optional)"/> <input class="form__field text-field" type="address" name="fields[address]" placeholder="Address (do not fill!)" style="display: none"/> <textarea class="form__field text-field" rows="10" name="fields[message]" placeholder="Comment. Markdown is accepted." required></textarea> <input class="large radius button" type="submit" value="Send" /> (after comment you will be redirected back here) </form></div></section></article></div></div><div id="up-to-top" class="row"><div class="small-12 columns" style="text-align: right;"> <a class="fontel-16 icon-chevron_up" href="#top-of-page"></a></div></div><footer id="footer-content" class="bg-grau"><div id="footer"><div class="row"><div class="medium-6 large-5 columns"><h5 class="shadow-black">About This Site</h5><p class="shadow-black"> This is the home of the Arizona Jugger League, LLC. We strive to create fun, competitive Jugger tournaments! <a href="http://localhost:4000/about/">More ›</a></div><div class="small-6 medium-3 large-3 large-offset-1 columns"><h5 class="shadow-black">Services</h5><ul class="no-bullet shadow-black"><li > <a href="http://localhost:4000" title=""></a><li > <a href="http://localhost:4000/feed.xml" title="Subscribe to RSS Feed">RSS</a><li > <a href="http://localhost:4000/atom.xml" title="Subscribe to Atom Feed">Atom</a><li > <a href="http://localhost:4000/sitemap.xml" title="Sitemap for Google Webmaster Tools">sitemap.xml</a></ul></div><div class="small-6 medium-3 large-3 columns"><h5 class="shadow-black">Useful links</h5><ul class="no-bullet shadow-black"><li > <a href="http://localhost:4000" title=""></a><li class="rss-link" > <a href="http://phlow.de/" target="_blank" title="Theme author">Phlow</a><li class="sitemap-link" > <a href="http://phlow.github.io/feeling-responsive/" target="_blank" title="Theme link">Feeling Responsive</a><li class="services-newsletter" > <a href="http://foundation.zurb.com/" target="_blank" title="Built on Foundation">Built on Foundation</a></ul></div></div></div><div id="subfooter"><nav class="row"><section id="subfooter-left" class="small-12 medium-6 columns credits"><p>© Arizona Jugger League, LLC (2025)</section><section id="subfooter-right" class="small-12 medium-6 columns"><ul class="inline-list social-icons"><li><a href="http://github.com/dexp" target="_blank" class="icon-github_alt" title="GitHub"></a><li><a href="https://www.linkedin.com/in/dexperix/" target="_blank" class="icon-linkedin" title="LinkedIn"></a><li><a href="http://steamcommunity.com/id/dexp" target="_blank" class="icon-steam" title="Steam"></a><li><a href="https://vk.com/dexperix" target="_blank" class="icon-vk" title="VKontakte"></a><li><a href="https://www.facebook.com/dexperix" target="_blank" class="icon-facebook" title="Facebook"></a><li><a href="skype:dexperix?chat" target="_blank" class="icon-skype" title="Skype"></a><li><a href="https://t.me/DeXPeriX" target="_blank" class="icon-telegram" title="Telegram"></a></ul></section></nav></div></footer><script src="http://localhost:4000/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-103240598-1', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script>
